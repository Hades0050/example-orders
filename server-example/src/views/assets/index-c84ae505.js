import{d as v,o as i,c,t as p,g as w,a as d,F as y,h,f as l,e as $,b as u,i as _,n as I,j as g,k as B,w as S,T as N,l as D,u as A,m as b,p as M,q as U,v as V}from"./index-4660a204.js";import{_ as E}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as C}from"./index.vue_vue_type_script_setup_true_lang-eeddab78.js";/* empty css                                              */var x=(n=>(n.ADMIN="ADMIN",n.USER="USER",n))(x||{});const F=["title"],O=v({__name:"index",props:{nameIcon:{requierd:!0,type:String},tooltip:{requierd:!0,type:String,default:""}},setup(n){const e=n;return(o,t)=>(i(),c("button",{title:e.tooltip,class:"btn-icon"},p(e.nameIcon),9,F))}}),m=E(O,[["__scopeId","data-v-73eb6882"]]);function T(n,e){return e||(e=()=>0),(o,t)=>o&&t&&o[n]>t[n]?1:o&&t&&t[n]>o[n]?-1:e(o,t)}function j(n,e){return e||(e=()=>0),(o,t)=>t&&o&&t[n]>o[n]?1:t&&o&&o[n]>t[n]?-1:e(o,t)}function z(n,e){let o=()=>0;n.reverse(),e.reverse();for(const[t,a]of n.entries()){const s=e[t];s==="asc"?o=T(a,o):s==="desc"&&(o=j(a,o))}return o}const R={key:0},G={key:0},H=v({__name:"index",props:{columns:{required:!1,type:Array,default:()=>{}},rows:{required:!1,type:Array,default:()=>{}},actionBtn:{required:!1,type:Boolean,default:!1}},setup(n){const e=n,o=w(()=>{let t=e.rows,a=[],s=[];return e.columns.forEach(r=>{r.sortable&&typeof r.order=="string"&&(a.push(r.order),s.push(r.field))}),t.sort(z(s,a)),t});return(t,a)=>(i(),c("table",null,[d("thead",null,[d("tr",null,[(i(!0),c(y,null,h(e.columns,s=>(i(),c("th",{key:s.name},[d("p",null,[$(p(s.label)+" ",1),s.sortable?(i(),c("span",R,[$(p(s.order)+" ",1),u(l(m),{tooltip:s.order==="desc"?"По возрастанию":"По убыванию","name-icon":s.order==="desc"?"↑":"↓",onClick:r=>s.order==="desc"?s.order="asc":s.order="desc"},null,8,["tooltip","name-icon","onClick"]),u(l(m),{tooltip:"Сброс сортировки","name-icon":"※",onClick:r=>s.order=null},null,8,["onClick"])])):_("",!0)])]))),128))])]),d("tbody",null,[(i(!0),c(y,null,h(l(o),s=>(i(),c("tr",{key:s},[(i(!0),c(y,null,h(e.columns,r=>(i(),c("td",{key:r.name},[d("span",{style:I(r.style?r.style(s[r.field]):"")},p(r.format?r.format(s[r.field]):s[r.field]),5)]))),128)),e.actionBtn?(i(),c("td",G,[e.actionBtn?g(t.$slots,"action",{key:0,row:s}):_("",!0)])):_("",!0)]))),128))])]))}}),J={class:"modal-overlay"},K={class:"modal container",role:"dialog"},L={class:"footer"},Q={style:{float:"left"}},W={style:{float:"right"}},X=v({__name:"index",props:{messsage:{requred:!1,type:String,default:"Сообщение"}},emits:["close","ok"],setup(n,{emit:e}){const o=n;return(t,a)=>(i(),B(N,{name:"modal-fade"},{default:S(()=>[d("div",J,[d("div",K,[d("section",null,[g(t.$slots,"body",{},()=>[d("p",null,p(o.messsage),1)])]),d("footer",L,[d("div",Q,[u(l(C),{label:"ОК",onClick:a[0]||(a[0]=s=>e("ok")),color:"white"})]),d("div",W,[u(l(C),{label:"Отмена",color:"white",onClick:a[1]||(a[1]=s=>e("close"))})])])])])]),_:3}))}}),Z={class:"container"},se=v({__name:"index",setup(n){const e=D(),o=A(),t=b(null),a=async()=>{await e.delete(t.value).then(()=>{t.value=null})};return M(async()=>{await e.fetch()}),(s,r)=>{var k;return i(),c("div",Z,[u(l(H),{columns:l(e).columns,rows:l(e).data,"action-btn":((k=l(o).user)==null?void 0:k.role)===l(x).ADMIN},{action:S(({row:f})=>[f.status==="Новый"?(i(),B(l(m),{key:0,tooltip:"Обновить статус","name-icon":"⋁",onClick:q=>l(e).updateStatus(f)},null,8,["onClick"])):_("",!0),u(l(m),{tooltip:"Удалить заказ","name-icon":"✗",onClick:q=>t.value=f},null,8,["onClick"])]),_:1},8,["columns","rows","action-btn"]),U(u(l(X),{messsage:"Вы действительно хотите удалить заказ?",onOk:r[0]||(r[0]=f=>a()),onClose:r[1]||(r[1]=f=>t.value=null)},null,512),[[V,t.value]])])}}});export{se as default};
